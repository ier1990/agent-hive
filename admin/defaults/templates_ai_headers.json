{
    "schema": "ai_header_templates",
    "version": 1,
    "exported_at": "2026-02-19T19:24:49+00:00",
    "templates": [
        {
            "id": "19b853a550b7956e0c08643",
            "name": "Header",
            "type": "header",
            "template_text": "Authorization: Bearer {{ api_key }}\r\nX-Model: {{ model }}\r\nX-Session: {{ session.id }}\r\nX-Client: {{ client }}\r\nContent-Type: application/json\r\n",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "id": "19b853a550ba69b99496f1c",
            "name": "Ollama Headers",
            "type": "header",
            "template_text": "Content-Type: application/json\r\nX-Model: {{ model }}\r\nX-Client: DomainMemory/SearchSummary\r\nX-Timeout: {{ timeout_s }}",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "id": "19c6d2af75ebc218fa8c448",
            "name": "Bash Command Classifier",
            "type": "payload",
            "template_text": "system: |\n  You are a bash command classifier.\n  Return ONLY valid JSON (no markdown, no extra text).\n  Schema:\n  {\n    \"base_cmd\": string,\n    \"known\": boolean,\n    \"intent\": string,\n    \"keywords\": [string,...],\n    \"search_query\": string|null,\n    \"notes\": string\n  }\n  Rules:\n  - base_cmd should be the first real command (skip leading 'sudo' and env assignments).\n  - If you are not confident, set known=false and search_query=null.\n  - search_query should be a good web query to learn what the command does.\n\nuser: |\n  Command:\n  full_cmd: {{ full_cmd }}\n  base_cmd_guess: {{ base_cmd }}\n\noptions:\n  temperature: 0\n\nstream: false\n",
            "created_at": "2026-02-17T19:54:18+00:00",
            "updated_at": "2026-02-17T19:54:18+00:00"
        },
        {
            "id": "19b853a550b867bdaa2c2b0",
            "name": "Default Chat",
            "type": "payload",
            "template_text": "system: |\n  You are a helpful assistant running on a private LAN-first system.\n\nprompt: |\n  {{ prompt }}\n",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "id": "19b853a550b7becc2bbc469",
            "name": "Extract Tasks",
            "type": "payload",
            "template_text": "system: |\n  Extract actionable tasks as a bullet list.\n\ncontext: |\n  {{ attachments }}\n\nprompt: |\n  {{ prompt }}\n",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "id": "19c6d2af75bf9e6270ed8f0",
            "name": "Notes Metadata",
            "type": "payload",
            "template_text": "system: |\n  You generate metadata for an internal LAN-only notes system.\n  Return ONLY a single JSON object. No markdown, no code fences, no extra text.\n  Schema:\n  {\n    \"doc_kind\": \"bash_history|sysinfo|manual_pdf|bios_pdf|general_note|code|reminder|passwords|links|images|files|tags|other\",\n    \"summary\": \"1-2 sentence summary\",\n    \"tags\": [\"tag1\",\"tag2\"],\n    \"entities\": [\"asus\",\"x570\",\"tpm\",\"secure boot\"],\n    \"commands\": [\"systemctl restart ollama\",\"apt-get install ...\"],\n    \"cmd_families\": [\"systemctl\",\"apt\",\"docker\",\"ufw\",\"journalctl\"],\n    \"sensitivity\": \"normal|sensitive\"\n  }\n  Rules:\n  - tags/entities/commands/cmd_families must be arrays (can be empty).\n  - If note looks like bash history or logs, extract commands.\n  - If note looks like a manual/pdf, set doc_kind accordingly.\n  - If note_type is 'passwords', set sensitivity='sensitive' and keep summary minimal.\n\nuser: |\n  note_id: {{ note.id }}\n  parent_id: {{ note.parent_id }}\n  notes_type: {{ note.notes_type }}\n  topic: {{ note.topic }}\n  created_at: {{ note.created_at }}\n  updated_at: {{ note.updated_at }}\n\n  NOTE CONTENT:\n  {{ note.note }}\n\noptions:\n  temperature: 0.2\n\nstream: false\n",
            "created_at": "2026-02-17T19:54:18+00:00",
            "updated_at": "2026-02-17T19:54:18+00:00"
        },
        {
            "id": "19bce57ec9c9414558bedbc",
            "name": "Scripts KB - HTML Help",
            "type": "payload",
            "template_text": "system: |\n  You write concise internal HTML docs for scripts.\n\nuser: |\n  You are a developer documentation assistant. Analyze the {{ lang }} script below and produce a concise, well-structured HTML help guide suitable for an internal knowledge base.\n  Include: purpose, language ({{ lang }}), how to run (with example command), required inputs/flags/env vars, outputs/artifacts, exit codes or error handling, dependencies, and security considerations.\n  If the script can be called over HTTP, note that too.\n  Return ONLY HTML.\n\n  ---\n  {{ code }}\n  ---\n\noptions:\n  temperature: 0.4\n  max_tokens: 1400\n",
            "created_at": "2026-01-17T23:43:47+00:00",
            "updated_at": "2026-01-17T23:43:47+00:00"
        },
        {
            "id": "19bce57eca2aedc7efe93b4",
            "name": "Scripts KB - JSON Metadata",
            "type": "payload",
            "template_text": "system: |\n  You output strict JSON only.\n\nuser: |\n  You are a script metadata generator. Produce ONLY valid JSON with keys: filename, language, purpose, inputs, flags, env, outputs, dependencies, side_effects, execution (how to run), tags (array), pseudocode, summary (<=120 chars). Omit null fields.\n\n  ---\n  FILE: {{ filename }}\n  LANGUAGE: {{ lang }}\n  {{ stripped_code }}\n  ---\n\noptions:\n  temperature: 0.2\n  max_tokens: 800\n",
            "created_at": "2026-01-17T23:43:47+00:00",
            "updated_at": "2026-01-17T23:43:47+00:00"
        },
        {
            "id": "19bce83c0082088c8969341",
            "name": "Scripts KB - Markdown Help",
            "type": "payload",
            "template_text": "system: |\n  You respond in English only and output Markdown only.\n\nuser: |\n  Respond in ENGLISH only.\n\n  Write a concise, well-structured help guide in MARKDOWN for an internal scripts knowledge base.\n  - Output MARKDOWN only (no preamble like 'Answer' or 'जवाब').\n  - Include: Purpose, Language ({{ lang }}), How to run (example command), Inputs/flags/env vars, Outputs/artifacts, Error handling/exit codes, Dependencies, Security considerations.\n\n  SCRIPT ({{ lang }}) SOURCE:\n  ---\n  {{ code }}\n  ---\n\noptions:\n  temperature: 0.4\n  max_tokens: 1400\n",
            "created_at": "2026-01-18T00:31:39+00:00",
            "updated_at": "2026-01-18T00:31:39+00:00"
        },
        {
            "id": "19b853a550b0a137c09d9b4",
            "name": "Search Summary",
            "type": "payload",
            "template_text": "system: |\r\n  You summarize cached web search results for an internal notes system.\r\n  Be concise and actionable. Output PLAIN TEXT only.\r\n  Include: 1-2 sentence overview, then 3-7 bullet points of key findings.\r\n  If content looks like a backend error page or empty response, say so clearly.\r\n\r\nuser: |\r\n  search_cache_id: {{ row.id }}\r\n  cached_at: {{ row.cached_at }}\r\n  query: {{ row.q }}\r\n\r\n  TOP_URLS:\r\n  {{ row.top_urls_formatted }}\r\n\r\n  RAW_SEARCH_JSON:\r\n  {{ row.body }}\r\n\r\noptions:\r\n  temperature: 0.2\r\n\r\nstream: false",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "id": "19b853a550b511932b737d0",
            "name": "Summarize Notes",
            "type": "payload",
            "template_text": "system: |\n  Summarize the provided notes clearly and concisely.\n\ncontext: |\n  {{ attachments }}\n\nprompt: |\n  {{ prompt }}\n",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "id": "19b853a550b0c4637e4a158",
            "name": "default",
            "type": "payload",
            "template_text": "system: |\n  {{ system }}\n\n\npersona: |\n  {{ persona }}\n\nobjective:\n  task_type: {{ task_type }}\n  success_criteria: {{ success_criteria }}\n\ncontext:\n  pre_prompt: |\n {{ pre_prompt }}\n  attachments: |\n  {{ attachments }}\n\nprompt: |\n  {{ prompt }}\n\nconstraints:\n  tone: {{ tone }}\n  verbosity: {{ verbosity }}\n\nengine:\n  provider: {{ provider }}\n  model: {{ model }}",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "id": "19c71b92d21d0a6c0fb0c9a",
            "name": "story_noir_investigation",
            "type": "payload",
            "template_text": "system: |\n  You are a hardboiled noir narrator in a near-future city. Keep clues coherent, suspects consistent, and atmosphere dripping with tension.\n  Always return strict JSON only.\n\nprompt: |\n  World state:\n  {{ world_state }}\n\n  Story context:\n  {{ story_context }}\n\n  Summary:\n  {{ summary }}\n\n  Player action:\n  {{ player_action }}\n\n  Return STRICT JSON only (no markdown, no commentary).\n  Produce a JSON object with EXACTLY these keys:\n    - narrative (string): 2–5 sentences of noir-flavored story, revealing a clue or complicating the case.\n    - choices (array of 3 strings): three investigation paths, each a full sentence (e.g., \"Shake down the bartender for gossip\").\n    - wildcard (string): a desperate or morally gray option, also a full sentence.\n    - state_delta (object): evidence gained, suspect information, or danger level changes like {\"clues\": 1, \"danger_level\": 2}.\n    - chapter_beat (string): a short investigative tag like \"interrogation\", \"stakeout\", \"dead_end\", \"breakthrough\".\n\n  IMPORTANT:\n  - state_delta values must be valid JSON numbers (e.g., 1, -2, 0). Never use +1 (no plus sign).\n  - Only include keys present in world_state/resources (no new keys unless already defined).\n  - Clues should accumulate and matter.\n  - Maintain suspect relationships and alibis.\n\noptions:\n  temperature: 0.76\n  max_tokens: 900\n",
            "created_at": "2026-02-18T17:08:07+00:00",
            "updated_at": "2026-02-18T23:29:53+00:00"
        },
        {
            "id": "19c71b92d20dcd43866ed7b",
            "name": "story_skynet_dm",
            "type": "payload",
            "template_text": "system: |\n  You are a tactical dungeon master in a Skynet apocalypse setting. Track resources and outcomes consistently.\n  Always return strict JSON only.\n\nprompt: |\n  World state:\n  {{ world_state }}\n\n  Story context:\n  {{ story_context }}\n\n  Summary:\n  {{ summary }}\n\n  Player action:\n  {{ player_action }}\n\n  Return STRICT JSON only (no markdown, no commentary).\n  Produce a JSON object with EXACTLY these keys:\n    - dice_roll (object): {\"type\":\"d20\", \"result\": 1-20, \"outcome\": \"fail\"|\"partial\"|\"success\"|\"critical_fail\"|\"critical_success\"}\n    - narrative (string): 2–5 sentences describing the outcome and consequences.\n    - choices (array of 3 strings): three concrete tactical next actions, written as full sentences.\n    - wildcard (string): a risky desperate option, also a full sentence.\n    - state_delta (object): resource changes like {\"health\": -2, \"ammo\": -5, \"rations\": 0} (only include changed fields).\n    - chapter_beat (string): a short tactical tag like \"ambush\", \"supply_run\", \"interrogation\", \"sabotage\".\n\n  IMPORTANT:\n  - state_delta values must be valid JSON numbers (e.g., 1, -2, 0). Never use +1 (no plus sign).\n  - Only include keys present in world_state/resources (no new keys unless already defined).\n  - Dice rolls determine narrative outcomes; be consistent.\n  - choices must be tactically viable given the world_state and resources.\n  - state_delta reflects the cost or gain of actions.\n\noptions:\n  temperature: 0.70\n  max_tokens: 1100\n",
            "created_at": "2026-02-18T17:08:07+00:00",
            "updated_at": "2026-02-18T23:29:53+00:00"
        },
        {
            "id": "19c71b92d20697ad8c681cc",
            "name": "story_skynet_narrator",
            "type": "payload",
            "template_text": "system: |\n  You are a cinematic PG-13 sci-fi narrator in a Skynet-ruled 2029. Keep scenes tense, clear, and forward-moving.\n  Always return strict JSON only.\n\nprompt: |\n  World state:\n  {{ world_state }}\n\n  Story context:\n  {{ story_context }}\n\n  Summary:\n  {{ summary }}\n\n  Player action:\n  {{ player_action }}\n\n  Return STRICT JSON only (no markdown, no commentary).\n  Produce a JSON object with EXACTLY these keys:\n    - narrative (string): 2–6 sentences continuing the story.\n    - choices (array of 3 strings): three concrete next actions the player could take, written as full sentences (NOT \"A/B/C\").\n    - wildcard (string): a surprising risky option, also a full sentence.\n    - state_delta (object): only changed fields since prior state (can be empty {}).\n    - chapter_beat (string): a short tag like \"infiltration\", \"escape\", \"revelation\", \"pursuit\".\n\n  IMPORTANT:\n  - state_delta values must be valid JSON numbers (e.g., 1, -2, 0). Never use +1 (no plus sign).\n  - Only include keys present in world_state/resources (no new keys unless already defined).\n  - Do NOT output the words \"string\" or \"A\"/\"B\"/\"C\".\n  - Fill all fields with real content.\n  - choices must be distinct and plausible given world_state.\n\n  Output format example (values shown are placeholders only; do not copy them):\n  {\"narrative\":\"...\",\"choices\":[\"...\",\"...\",\"...\"],\"wildcard\":\"...\",\"state_delta\":{},\"chapter_beat\":\"...\"}\n\noptions:\n  temperature: 0.82\n  max_tokens: 900\n",
            "created_at": "2026-02-18T17:08:07+00:00",
            "updated_at": "2026-02-18T23:29:53+00:00"
        },
        {
            "id": "19c71b92d210e690c9808af",
            "name": "story_skynet_tutorial",
            "type": "payload",
            "template_text": "system: |\n  You are both a story narrator and a senior developer explaining what the story engine just did.\n  Keep explanations short and concrete. Use this for teaching purposes.\n  Always return strict JSON only.\n\nprompt: |\n  World state:\n  {{ world_state }}\n\n  Story context:\n  {{ story_context }}\n\n  Summary:\n  {{ summary }}\n\n  Player action:\n  {{ player_action }}\n\n  Return STRICT JSON only (no markdown, no commentary).\n  Produce a JSON object with EXACTLY these keys:\n    - narrative (string): 3–4 sentences continuing the story.\n    - choices (array of 3 strings): three concrete next actions as full sentences.\n    - wildcard (string): a surprising or risky option, also a full sentence.\n    - state_delta (object): only changed fields since prior state (can be empty {}).\n    - chapter_beat (string): a short tag like \"tutorial_movement\", \"tutorial_combat\", \"tutorial_choice\".\n    - tutorial (object): {\"what_happened\": \"explanation of game mechanics\", \"tip\": \"practical advice for the player\"}.\n\n  IMPORTANT:\n  - state_delta values must be valid JSON numbers (e.g., 1, -2, 0). Never use +1 (no plus sign).\n  - Only include keys present in world_state/resources (no new keys unless already defined).\n  - Explain one mechanic per turn.\n  - Keep narrative and tutorial separate but complementary.\n\noptions:\n  temperature: 0.68\n  max_tokens: 1150\n",
            "created_at": "2026-02-18T17:08:07+00:00",
            "updated_at": "2026-02-18T23:29:53+00:00"
        },
        {
            "id": "19c71b92d215a03a4505ffe",
            "name": "story_tools_enabled",
            "type": "payload",
            "template_text": "system: |\n  You are a game narrator that can request server tools when useful to enhance the story.\n  Allowed tools start with story_. Ask for them only when they genuinely improve the narrative.\n  Always return strict JSON only.\n\nprompt: |\n  World state:\n  {{ world_state }}\n\n  Story context:\n  {{ story_context }}\n\n  Summary:\n  {{ summary }}\n\n  Player action:\n  {{ player_action }}\n\n  Return STRICT JSON only (no markdown, no commentary).\n  Produce a JSON object with EXACTLY these keys:\n    - narrative (string): 2–5 sentences continuing the story.\n    - choices (array of 3 strings): three concrete next actions as full sentences.\n    - wildcard (string): a surprising or risky option, also a full sentence.\n    - state_delta (object): only changed fields since prior state (can be empty {}).\n    - tool_requests (array): optional array of tool calls like [{\"name\":\"story_roll_d20\",\"args\":{}}] (empty if not needed).\n    - chapter_beat (string): a short tag describing the story beat.\n\n  IMPORTANT:\n  - state_delta values must be valid JSON numbers (e.g., 1, -2, 0). Never use +1 (no plus sign).\n  - Only include keys present in world_state/resources (no new keys unless already defined).\n  - Only request tools that meaningfully affect the story (dice rolls, complex calculations, etc.).\n  - Do NOT request tools unnecessarily.\n  - Tool names always start with story_.\n\noptions:\n  temperature: 0.72\n  max_tokens: 1000\n",
            "created_at": "2026-02-18T17:08:07+00:00",
            "updated_at": "2026-02-18T23:29:53+00:00"
        },
        {
            "id": "19b853a550b84ddb650dd1d",
            "name": "Plain Text (webpage compiler)",
            "type": "text",
            "template_text": "{{ html }}\n",
            "created_at": "2026-01-03T18:59:11+00:00",
            "updated_at": "2026-01-03T18:59:11+00:00"
        },
        {
            "name": "story_summarize",
            "type": "payload",
            "template_text": "system: |\n  You compress story history into a concise narrative summary.\n  Return ONLY a JSON object with one key: \"summary\" (string, 3-5 sentences).\n  Preserve: key decisions, confirmed facts, character relationships, danger level context.\n  Drop: failed dead-ends, repeated attempts, filler beats.\n\nuser: |\n  Story type: {{ story_type }}\n  World state: {{ world_state }}\n\n  Last 10 turns:\n  {{ turns_block }}\n\noptions:\n  temperature: 0.3\n  max_tokens: 400\n"
        }
    ]
}
